<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>자기소개표 생성기</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>
    <style>
        /* 태그 관련 스타일 */
        #profileTags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }
        
        .tag-item {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0 12px;
            height: 28px;
            border-radius: 8px;
            font-size: 14px;
            line-height: 28px; /* 텍스트를 수직 가운데로 */
            text-align: center;
            margin: 2px;
        }

        /* 기본 레이아웃 */
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* 프로필 이미지 */
        .profile-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 9999px;
        }
        
        /* 배경 이미지 */
        #profileSection {
            position: relative;
            overflow: hidden;
            min-height: 120px;
        }
        
        .bg-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }
        
        .profile-bg {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .profile-content {
            position: relative;
            z-index: 1;
        }
        
        .has-bg-image {
            border: 1px dashed #e9d5ff;
            background-color: rgba(250, 245, 255, 0.3);
        }
        
        /* 버튼 스타일 - 토글 활성화 색상 변경 */
        .option-btn {
            transition: all 0.2s;
        }
        
        /* 상세 정보 영역 - 간격 조정 */
        .info-grid {
            display: grid;
            grid-template-columns: 4.5rem 1fr; /* 라벨 부분 너비 유지 */
            align-items: flex-start; /* 상단 정렬로 변경 */
            gap: 0.25rem; /* 간격 유지 */
            line-height: 1.5; /* 일관된 줄 높이 설정 */
            margin-bottom: 0.5rem; /* 항목 간 간격 일관되게 */
        }

        .info-label {
            padding-right: 2px;
            white-space: nowrap;
            font-size: 0.9rem;
            line-height: 1.5; /* 라벨에도 동일한 줄 높이 적용 */
        }

        /* 내용 부분 스타일 추가 */
        .info-grid > div:nth-child(2) {
            line-height: 1.5; /* 내용 부분에도 동일한 줄 높이 적용 */
            padding-top: 1px; /* 미세 조정 */
        }

        /* 헤더 텍스트 위치 조정 */
        #cardHeader {
            display: flex;
            align-items: center;
            height: 48px;
        }

        /* 반응형 */
        @media (min-width: 768px) {
            #profileCard {
                position: sticky;
                top: 20px;
            }
        }
        
        /* 태그 추가 및 이미지 저장 버튼 색상 변경 */
        .custom-button {
            background-color: #E0B664;
            color: white;
        }
        
        .custom-button:hover {
            background-color: #d5a649;
        }
        
        /* 새로 추가된 레이아웃 스타일 */
        .info-container {
            display: flex;
            flex-direction: row;
            gap: 12px;
            margin: 0 4px;
        }
        
        .detail-box {
            flex: 3;
        }
        
        .tags-box {
            flex: 2;
        }
        
        @media (max-width: 640px) {
            .info-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="container flex flex-col md:flex-row">
        <!-- 설정 패널 -->
        <div class="w-full md:w-1/3 p-4 bg-white border-r border-gray-200 overflow-y-auto">
            <h1 class="text-xl font-bold mb-6">자기소개표 생성기</h1>
            
            <!-- 테마 색상 설정 -->
            <div class="mb-6">
                <button 
                    class="flex items-center justify-between w-full text-lg font-semibold mb-3 bg-gray-100 p-2 rounded"
                    onclick="toggleSection('themeSection')"
                >
                    <span>테마 색상 설정</span>
                    <svg id="themeToggleIcon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="transform transition-transform">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>
                
                <div id="themeSection">
                    <!-- 헤더 제목 설정 -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-1">헤더 제목</label>
                        <div class="flex">
                            <input 
                                type="text" 
                                id="headerTitle" 
                                value="AI Chat 자기소개표" 
                                placeholder="헤더 제목을 입력하세요" 
                                class="flex-grow p-2 border border-gray-300 rounded-l"
                                oninput="updateHeaderTitle(this.value)"
                            >
                            <div class="flex flex-col items-center">
                                <input 
                                    type="color" 
                                    id="headerTextColor" 
                                    value="#8C6717" 
                                    class="h-full px-2 py-1 border border-gray-300 rounded-r"
                                    oninput="updateHeaderTextColor(this.value)"
                                >
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-3 gap-0 mb-4">
                        <div class="flex flex-col items-center">
                            <label class="block text-sm font-medium mb-1 text-center">헤더 색상</label>
                            <input type="color" id="headerColor" value="#F7F4CB" class="h-10 w-16">
                        </div>
                        
                        <div class="flex flex-col items-center">
                            <label class="block text-sm font-medium mb-1 text-center">태그 배경 색상</label>
                            <input type="color" id="tagColor" value="#EFDAB1" class="h-10 w-16">
                        </div>
                        
                        <div class="flex flex-col items-center">
                            <label class="block text-sm font-medium mb-1 text-center">태그 텍스트 색상</label>
                            <input type="color" id="tagTextColor" value="#8C6717" class="h-10 w-16">
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 이미지 설정 섹션 -->
            <div class="mb-6">
                <button 
                    class="flex items-center justify-between w-full text-lg font-semibold mb-3 bg-gray-100 p-2 rounded"
                    onclick="toggleSection('imageSection')"
                >
                    <span>이미지 설정</span>
                    <svg id="imageToggleIcon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="transform transition-transform">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>
                
                <div id="imageSection" class="hidden">
                    <!-- 프로필 이미지 설정 -->
                    <div class="mb-4 p-3 border border-gray-200 rounded">
                        <h3 class="text-md font-medium mb-2">프로필 이미지</h3>
                        <input 
                            type="text" 
                            id="profileImageUrl" 
                            placeholder="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSkGHVkHhOalIBxWeuKVuV-8T4hGPXVBIgTNw&s" 
                            class="w-full p-2 border border-gray-300 rounded"
                        >
                    </div>
                    
                    <!-- 배경 이미지 설정 -->
                    <div class="p-3 border border-gray-200 rounded">
                        <h3 class="text-md font-medium mb-2">배경 이미지</h3>
                        <input 
                            type="text" 
                            id="backgroundImageUrl" 
                            placeholder="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSkGHVkHhOalIBxWeuKVuV-8T4hGPXVBIgTNw&s" 
                            class="w-full p-2 border border-gray-300 rounded mb-3"
                        >
                        
                        <label class="block text-sm font-medium mb-1">배경 투명도: <span id="opacityValue">50%</span></label>
                        <input 
                            type="range" 
                            id="backgroundOpacity" 
                            min="0" 
                            max="100" 
                            value="50" 
                            class="w-full"
                            oninput="document.getElementById('opacityValue').textContent = this.value + '%'"
                        >
                    </div>
                </div>
            </div>
            
            <!-- 프로필 정보 섹션 -->
            <div class="mb-6">
                <h2 class="text-lg font-semibold mb-3">프로필 정보</h2>
                
                <div class="mb-3">
                    <label class="block text-sm font-medium mb-1">닉네임/아이디</label>
                    <input 
                        type="text" 
                        id="nickname" 
                        placeholder="닉네임 (@아이디)" 
                        class="w-full p-2 border border-gray-300 rounded"
                    >
                </div>
                
                <div class="mb-3">
                    <label class="block text-sm font-medium mb-1">소개</label>
                    <textarea 
                        id="bio" 
                        class="w-full p-2 border border-gray-300 rounded"
                        rows="2"
                        placeholder="자신을 간단히 소개해주세요."
                    ></textarea>
                </div>
            </div>
            
            <!-- 상세 정보 섹션 - 기존 토글 버튼 방식 - 모든 토글 기본 선택됨 -->
            <div class="mb-6">
                <button 
                    class="flex items-center justify-between w-full text-lg font-semibold mb-3 bg-gray-100 p-2 rounded"
                    onclick="toggleSection('detailSection')"
                >
                    <span>상세 정보</span>
                    <svg id="detailToggleIcon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="transform transition-transform">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>
                
                <div id="detailSection">
                    <!-- 관계 정리 -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">관계 정리</label>
                        <div class="flex flex-wrap gap-2" id="accountStatusOptions">
                            <button 
                                type="button" 
                                class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" 
                                data-target="accountStatus" 
                                data-value="블락"
                                onclick="toggleOption(this)"
                            >
                                블락
                            </button>
                            <button 
                                type="button" 
                                class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" 
                                data-target="accountStatus" 
                                data-value="블언블"
                                onclick="toggleOption(this)"
                            >
                                블언블
                            </button>
                            <button 
                                type="button" 
                                class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" 
                                data-target="accountStatus" 
                                data-value="언팔"
                                onclick="toggleOption(this)"
                            >
                                언팔
                            </button>
                        </div>
                        <input type="hidden" id="accountStatus" value="블락,블언블,언팔">
                    </div>
                    
                    <!-- 지뢰 (텍스트 입력) -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">지뢰</label>
                        <input 
                            type="text" 
                            id="sinic" 
                            placeholder="지뢰가 되는 요소를 입력하세요" 
                            class="w-full p-2 border border-gray-300 rounded"
                        >
                    </div>
                    
                    <!-- 지뢰 대응 -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">지뢰 대응</label>
                        <div class="flex flex-wrap gap-2" id="speechTypeOptions">
                            <button 
                                type="button" 
                                class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" 
                                data-target="speechType" 
                                data-value="무시가능"
                                onclick="toggleOption(this)"
                            >
                                무시가능
                            </button>
                            <button 
                                type="button" 
                                class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" 
                                data-target="speechType" 
                                data-value="직멘제외무시가능"
                                onclick="toggleOption(this)"
                            >
                                직멘제외무시가능
                            </button>
                            <button 
                                type="button" 
                                class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" 
                                data-target="speechType" 
                                data-value="무시불가능"
                                onclick="toggleOption(this)"
                            >
                                무시불가능
                            </button>
                        </div>
                        <input type="hidden" id="speechType" value="무시가능,직멘제외무시가능,무시불가능">
                    </div>
                    
                    <!-- 트윗 성향 -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">트윗 성향</label>
                        <div class="flex flex-wrap gap-2" id="tweetStyleOptions">
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="tweetStyle" data-value="일상" onclick="toggleOption(this)">일상</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="tweetStyle" data-value="RT" onclick="toggleOption(this)">RT</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="tweetStyle" data-value="타장르언급" onclick="toggleOption(this)">타장르언급</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="tweetStyle" data-value="욕설" onclick="toggleOption(this)">욕설</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="tweetStyle" data-value="우울" onclick="toggleOption(this)">우울</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="tweetStyle" data-value="R18" onclick="toggleOption(this)">R18</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="tweetStyle" data-value="폭력성" onclick="toggleOption(this)">폭력성</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="tweetStyle" data-value="고어" onclick="toggleOption(this)">고어</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="tweetStyle" data-value="탐라대화" onclick="toggleOption(this)">탐라대화</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="tweetStyle" data-value="마음요정" onclick="toggleOption(this)">마음요정</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="tweetStyle" data-value="인용대화" onclick="toggleOption(this)">인용대화</button>
                        </div>
                        <input type="hidden" id="tweetStyle" value="일상,RT,타장르언급,욕설,우울,R18,폭력성,고어,탐라대화,마음요정,인용대화">
                    </div>
                    
                    <!-- 성향 -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">성향</label>
                        <div class="flex flex-wrap gap-2" id="playStyleOptions">
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="playStyle" data-value="제작자" onclick="toggleOption(this)">제작자</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="playStyle" data-value="소비자" onclick="toggleOption(this)">소비자</button>
                        </div>
                        <input type="hidden" id="playStyle" value="제작자,소비자">
                    </div>
                    
                    <!-- 플랫폼 (텍스트 입력) -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">플랫폼</label>
                        <input 
                            type="text" 
                            id="platform" 
                            placeholder="이용 중인 플랫폼을 입력하세요" 
                            class="w-full p-2 border border-gray-300 rounded"
                        >
                    </div>
                    
                    <!-- CP 성향 -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">CP 성향</label>
                        <div class="flex flex-wrap gap-2" id="cpPreferenceOptions">
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="cpPreference" data-value="HL" onclick="toggleOption(this)">HL</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="cpPreference" data-value="BL" onclick="toggleOption(this)">BL</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="cpPreference" data-value="GL" onclick="toggleOption(this)">GL</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="cpPreference" data-value="ALL" onclick="toggleOption(this)">ALL</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="cpPreference" data-value="NCP" onclick="toggleOption(this)">NCP</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="cpPreference" data-value="리버시블" onclick="toggleOption(this)">리버시블</button>
                            <button type="button" class="px-3 py-1 border border-gray-300 rounded text-sm option-btn active" data-target="cpPreference" data-value="논리버시블" onclick="toggleOption(this)">논리버시블</button>
                        </div>
                        <input type="hidden" id="cpPreference" value="HL,BL,GL,ALL,NCP,리버시블,논리버시블">
                    </div>
                </div>
            </div>
            
            <!-- 태그 관리 섹션 -->
            <div class="mb-6">
                <h2 class="text-lg font-semibold mb-3">태그 관리</h2>
                
                <div class="flex mb-3">
                    <input 
                        type="text" 
                        id="newTag" 
                        placeholder="새 태그 입력" 
                        class="flex-grow p-2 border border-gray-300 rounded-l"
                    >
                    <button 
                        onclick="addTag()" 
                        class="custom-button px-3 py-2 rounded-r"
                    >
                        추가
                    </button>
                </div>
                
                <div class="flex flex-wrap gap-2 mb-3" id="tagList">
                    <!-- 태그 목록이 여기에 추가됩니다 -->
                </div>
            </div>
            
            <!-- 버튼 영역 -->
            <div class="flex gap-2 mb-4">
                <button 
                    onclick="updatePreview()" 
                    class="flex-1 bg-blue-500 text-white py-2 px-4 rounded"
                >
                    미리보기 업데이트
                </button>
                
                <button 
                    onclick="downloadImage()" 
                    class="flex-1 custom-button py-2 px-4 rounded"
                >
                    이미지로 저장
                </button>
            </div>
            
            <!-- 메시지 영역 -->
            <div id="statusMessage" class="mt-1 p-2 rounded text-center hidden"></div>
        </div>
        
        <!-- 미리보기 패널 -->
        <div class="w-full md:w-2/3 p-4 bg-gray-100 flex justify-center items-start overflow-y-auto">
            <div class="w-full max-w-md">
                <h2 class="text-lg font-semibold mb-4">미리보기</h2>
                
                <div class="rounded-lg overflow-hidden shadow-lg bg-white sticky top-4" id="profileCard">
                    <!-- 헤더 부분 -->
                    <div class="p-3 text-xl font-bold" id="cardHeader" style="background-color: #F7F4CB; color: #8C6717;">
                        AI Chat 자기소개표
                    </div>
                    
                    <!-- 프로필 섹션 -->
                    <div class="p-4 bg-white" id="profileSection">
                        <!-- 배경 이미지 -->
                        <div id="backgroundImageContainer" class="bg-container hidden">
                            <img id="backgroundImage" class="profile-bg" src="" alt="배경 이미지">
                        </div>
                        
                        <div class="flex items-start mb-2 profile-content">
                            <!-- 프로필 이미지 -->
                            <div id="profileImageContainer" class="w-20 h-20 rounded-full mr-4 flex-shrink-0 flex items-center justify-center text-xs text-gray-400 bg-gray-200">
                                <span id="profileImagePlaceholder">100 x 100</span>
                                <img id="profileImage" class="profile-image hidden" src="" alt="프로필 이미지">
                            </div>
                            
                            <!-- 기본 정보 -->
                            <div>
                                <div class="font-bold text-gray-700 mb-1" id="profileName">
                                    닉네임 (@아이디)
                                </div>
                                <div class="text-sm text-gray-600" id="profileBio">
                                    자신을 간단히 소개해주세요.
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 가로 배치된 상세 정보와 태그 섹션 -->
                    <div class="info-container my-2">
                        <!-- 상세 정보 섹션 -->
                        <div class="detail-box border border-gray-200 p-4 rounded bg-white">
                            <div class="info-grid mb-2">
                                <div class="text-gray-600 font-medium info-label">관계 정리:</div>
                                <div class="text-gray-800" id="profileAccountStatus">블락,블언블,언팔</div>
                            </div>
                            
                            <div class="info-grid mb-2">
                                <div class="text-gray-600 font-medium info-label">지뢰:</div>
                                <div class="text-gray-800" id="profileSinic"></div>
                            </div>
                            
                            <div class="info-grid mb-2">
                                <div class="text-gray-600 font-medium info-label">지뢰 대응:</div>
                                <div class="text-gray-800" id="profileSpeechType">무시가능,직멘제외무시가능,무시불가능</div>
                            </div>
                            
                            <div class="info-grid mb-2">
                                <div class="text-gray-600 font-medium info-label">트윗 성향:</div>
                                <div class="text-gray-800" id="profileTweetStyle">일상,RT,타장르언급,욕설,우울,R18,폭력성,고어,탐라대화,마음요정,인용대화</div>
                            </div>
                            
                            <div class="info-grid mb-2">
                                <div class="text-gray-600 font-medium info-label">성향:</div>
                                <div class="text-gray-800" id="profilePlayStyle">제작자,소비자</div>
                            </div>
                            
                            <div class="info-grid mb-2">
                                <div class="text-gray-600 font-medium info-label">플랫폼:</div>
                                <div class="text-gray-800" id="profilePlatform"></div>
                            </div>
                            
                            <div class="info-grid mb-2">
                                <div class="text-gray-600 font-medium info-label">CP 성향:</div>
                                <div class="text-gray-800" id="profileCpPreference">HL,BL,GL,ALL,NCP,리버시블,논리버시블</div>
                            </div>