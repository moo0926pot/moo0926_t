<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- 기존 코드 유지 -->
    <style>
        /* 추가 스타일 */
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .profile-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 9999px;
        }
        
        /* 배경 이미지 관련 스타일 수정 */
        #profileSection {
            position: relative;
            overflow: hidden; /* 이미지가 영역을 벗어나지 않도록 */
            min-height: 120px;
        }
        #backgroundImageContainer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0; /* z-index 값 상향 조정 */
        }
        .profile-bg {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .profile-content {
            position: relative;
            z-index: 1; /* 내용이 배경 위에 표시되도록 */
        }
        .has-bg-image {
            border: 1px dashed #e9d5ff;
            background-color: rgba(250, 245, 255, 0.3); /* 더 투명하게 조정 */
        }
        
        /* 기존 스타일 유지 */
        .option-btn {
            transition: all 0.2s;
        }
        .option-btn.active {
            background-color: #d8b4fe;
            color: white;
            border-color: #d8b4fe;
        }
        @media (min-width: 768px) {
            .container {
                min-height: 100vh;
                height: 100vh;
            }
            
            .overflow-y-auto {
                max-height: 100vh;
            }
            
            #profileCard {
                position: sticky;
                top: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- 기존 코드 유지 -->
    
    <!-- 프로필 섹션 부분 수정 -->
    <div class="p-4 bg-white" id="profileSection">
        <!-- 배경 이미지 - 위치 변경 -->
        <div id="backgroundImageContainer" class="hidden">
            <img id="backgroundImage" class="profile-bg" src="" alt="배경 이미지">
        </div>
        
        <div class="flex items-start mb-2 profile-content">
            <!-- 프로필 이미지 -->
            <div id="profileImageContainer" class="w-20 h-20 rounded-full mr-4 flex-shrink-0 flex items-center justify-center text-xs text-gray-400 bg-gray-200">
                <span id="profileImagePlaceholder">100 x 100</span>
                <img id="profileImage" class="profile-image hidden" src="" alt="프로필 이미지">
            </div>
            
            <!-- 기본 정보 -->
            <div>
                <div class="font-bold text-gray-700 mb-1" id="profileName">
                    닉네임 (@아이디)
                </div>
                <div class="text-sm text-gray-600" id="profileBio">
                    자신을 간단히 소개해주세요.
                </div>
            </div>
        </div>
    </div>
    
    <!-- 기존 코드 유지 -->

    <script>
        // 기존 코드 유지
        
        // 배경 이미지 업데이트 함수 수정
        function updateBackgroundImage() {
            const imageUrl = document.getElementById('backgroundImageUrl').value.trim();
            const opacity = document.getElementById('backgroundOpacity').value;
            const backgroundImageContainer = document.getElementById('backgroundImageContainer');
            const backgroundImage = document.getElementById('backgroundImage');
            const profileSection = document.getElementById('profileSection');
            
            console.log("배경 이미지 URL:", imageUrl); // 디버깅용
            
            if (imageUrl !== '') {
                // 이미지 URL이 있을 경우 배경 이미지 표시
                backgroundImage.src = imageUrl;
                backgroundImageContainer.classList.remove('hidden');
                
                // 투명도 적용
                backgroundImage.style.opacity = opacity / 100;
                
                // 프로필 섹션에 배경 있음 클래스 추가
                profileSection.classList.add('has-bg-image');
                
                // 이미지 로드 성공 시 로그
                backgroundImage.onload = function() {
                    console.log("배경 이미지 로드 성공");
                };
                
                // 이미지 로드 오류 처리
                backgroundImage.onerror = function() {
                    console.log("배경 이미지 로드 실패");
                    backgroundImageContainer.classList.add('hidden');
                    profileSection.classList.remove('has-bg-image');
                    alert('배경 이미지를 불러올 수 없습니다. 올바른 URL인지 확인해주세요.');
                };
            } else {
                // 이미지 URL이 없을 경우 배경 이미지 숨김
                backgroundImageContainer.classList.add('hidden');
                profileSection.classList.remove('has-bg-image');
            }
        }
        
        // 기존 코드 유지
    </script>
</body>
</html>